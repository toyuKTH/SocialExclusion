// å¯åŠ¨ SuperCollider æœåŠ¡å™¨
s.waitForBoot({

    // ğŸµ å®šä¹‰å·´æ¾ï¼ˆBassoonï¼‰åˆæˆå™¨
    SynthDef(\bassoon, { |freq = 440, amp = 0.3, dur = 2|
        var env = EnvGen.kr(Env.perc(0.1, dur), doneAction: 2);
        var sound = VarSaw.ar(freq, 0, 0.4) * env * amp;
        Out.ar(0, sound);
    }).add;

    // ğŸº å®šä¹‰å°å·ï¼ˆTrumpetï¼‰åˆæˆå™¨
    SynthDef(\trumpet, { |freq = 440, amp = 0.3, dur = 2|
        var env = EnvGen.kr(Env.perc(0.05, dur), doneAction: 2);
        var sound = Saw.ar(freq) * env * amp;
        Out.ar(0, sound);
    }).add;

    // ğŸ§ ç›‘å¬ WebSocket æœåŠ¡å™¨å‘é€çš„ OSC æ¶ˆæ¯
    OSCdef(\country_info, { |msg|
        var group = msg[1].asSymbol;  // è§£æç¾¤ä½“ (total, male, female)
        var value = msg[2].asFloat;   // è§£ææ•°å€¼
        var freq = value * 10;        // è®¡ç®—é¢‘ç‡

        // âœ… ç¡®ä¿é¢‘ç‡æœ‰æ•ˆï¼Œé¿å…æ’­æ”¾é”™è¯¯
        if (freq.isNaN or: { freq <= 0 }) {
            freq = 440; // é»˜è®¤é¢‘ç‡ A4
        };

        // ğŸ¼ é€‰æ‹©ä¹å™¨æ’­æ”¾
        if (group == \total) {
            Synth(\bassoon, [\freq, freq]);
            Synth(\trumpet, [\freq, freq]);
            ("ğŸµ æ’­æ”¾å·´æ¾ & å°å·ï¼Œé¢‘ç‡: " ++ freq).postln;
        } {
            if (group == \female) {
                Synth(\trumpet, [\freq, freq]);
                ("ğŸº ä»…æ’­æ”¾å°å·ï¼Œé¢‘ç‡: " ++ freq).postln;
            } {
                if (group == \male) {
                    Synth(\bassoon, [\freq, freq]);
                    ("ğŸ» ä»…æ’­æ”¾å·´æ¾ï¼Œé¢‘ç‡: " ++ freq).postln;
                };
            };
        };

    }, '/country_info');

    "âœ… SuperCollider æœåŠ¡å™¨å·²å¯åŠ¨ï¼Œç­‰å¾… OSC æ¶ˆæ¯...".postln;

});
